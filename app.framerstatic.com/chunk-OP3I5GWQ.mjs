import{d,e as h,h as g}from"https://app.framerstatic.com/chunk-FKVUZ4GS.mjs";import{g as v}from"https://app.framerstatic.com/chunk-EHY3EVAD.mjs";import{a as w}from"https://app.framerstatic.com/chunk-U6TQH26S.mjs";import{a as s}from"https://app.framerstatic.com/chunk-WNSBRACC.mjs";import{e as k}from"https://app.framerstatic.com/chunk-B3PEGEKP.mjs";function W(n,e){if(n.size!==e.size)return!1;for(let t of n)if(!e.has(t))return!1;return!0}function R(n,e){if(n===e)return!0;let t=n.length;if(t!==e.length)return!1;for(let r=0;r<t;r++)if(n[r]!=e[r])return!1;return!0}function O(n,e){if(n===e)return!0;let t=Object.keys(n),r=t.length;if(r!==Object.keys(e).length)return!1;for(let i=r;i--!==0;){let o=t[i];if(g(o)||n[o]!=e[o])return!1}return!0}function j(n,e){if(n===e)return!0;let t=Object.keys(n),r=t.length;if(r!==Object.keys(e).length)return!1;for(let i=r;i--!==0;){let o=t[i];if(g(o)||n[o]!==e[o])return!1}return!0}function m(n,e){return n===e?!0:h(n)?h(e)?R(n,e):!1:d(n)&&d(e)?n instanceof Set?e instanceof Set?W(n,e):!1:O(n,e):!1}var l=k(w());var f=!1,S,c={vekterEngineInStore:"EngineStore subclasses shouldn't reference VekterEngine. Express dependencies on other stores by passing them explicitly",accessingStoreStateNotAllowed:"You can't access store state inside the store.useState() hook. Use the result of useState or the state snapshot that's passed to calculateState instead",invalidStoreCreation:"EngineStores should be constructed with Store.new() instead of new Store()",deleteProperty:"EngineStore does not support deleting properties. Assign undefined instead"},y=class{constructor(e){this.store=e;this.proxyHandler={set:(e,t,r,i)=>{if(!this.engine||!this.storeProxy||b(t))return Reflect.set(e,t,r,i);s(!this.engine.inRendering,"Cannot change store state while rendering");let o=Reflect.get(e,t,i),a=Reflect.set(e,t,r,i);return Reflect.get(e,t,i)!==o&&(this.stateSnapshot=void 0,this.engine.signalChanges(this.storeProxy)),a},get:(e,t,r)=>(s(S!==this,c.accessingStoreStateNotAllowed),Reflect.get(e,t,r)),deleteProperty(){throw new Error(c.deleteProperty)}};this.useState=e=>{let{engine:t,storeProxy:r}=this;s(t,"EngineStoreDriver must be initialized with an engine"),s(r,"EngineStoreDriver must be initialized with a storyProxy");let i=(0,l.useRef)();i.current=u=>{let p=this.getSnapshot();if(!e)return p;try{S=this;let E=e(p);return m(u,E)?u:E}finally{S=void 0}};let[o,a]=(0,l.useState)(i.current);return(0,l.useEffect)(()=>{let u=t.changes.observe(r,()=>{v.benchmarkSkipRendering||a(i.current)});return()=>t.changes.removeObserver(u)},[t,r]),o}}initialize(e,t){s(!this.engine,"EngineStoreDriver can only be initialized once"),this.engine=e,this.storeProxy=t}getSnapshot(){if(this.stateSnapshot)return this.stateSnapshot;let e={},t=Object.getPrototypeOf(this.store),r=Object.getOwnPropertyNames(t),i=Object.keys(this.store).concat(r);s(this.storeProxy,"EngineStoreDriver must be initialized with a storyProxy");for(let o of i){if(b(o))continue;let a=this.storeProxy[o];a!==void 0&&typeof a!="function"&&(e[o]=a)}return this.stateSnapshot=e}};function b(n){return n==="driver"||n==="constructor"||n==="useState"}var x=class{constructor(){this.driver=new y(this);this.useState=this.driver.useState;this.process=e=>{s(this.driver.engine,"EngineStore must be initialized before calling process"),this.driver.engine.process(e)};this.processWhenReady=e=>{s(this.driver.engine,"EngineStore must be initialized before calling processWhenReady"),this.driver.engine.processWhenReady(e)};this.processWhenReadyAsync=e=>(s(this.driver.engine,"EngineStore must be initialized before calling processWhenReadyAsync"),this.driver.engine.processWhenReadyAsync(e));this.runBeforeNextFrame=e=>{s(this.driver.engine,"EngineStore must be initialized before calling runBeforeNextFrame"),this.driver.engine.runBeforeNextFrame(e)};this.runWithFullyLoadedTree=(e,t)=>(s(this.driver.engine,"EngineStore must be initialized before calling runWithFullyLoadedTree"),this.driver.engine.runWithFullyLoadedTree(e,t));this.runWhenIdle=e=>{s(this.driver.engine,"EngineStore must be initialized before calling runWhenIdle"),this.driver.engine.runWhenIdle(e)};this.signalNonUserEvent=()=>{s(this.driver.engine,"EngineStore must be initialized before calling signalNonUserEvent"),this.driver.engine.signalNonUserEvent()};return s(f,c.invalidStoreCreation),new Proxy(this,this.driver.proxyHandler)}static new(e,...t){for(let r of t)s(r!==e,c.vekterEngineInStore);try{f=!0;let r=new this(...t);return r.driver.initialize(e,r),r}finally{f=!1}}};export{W as a,R as b,O as c,j as d,m as e,x as f};
//# sourceMappingURL=https://app.framerstatic.com/chunk-OP3I5GWQ.mjs.map
