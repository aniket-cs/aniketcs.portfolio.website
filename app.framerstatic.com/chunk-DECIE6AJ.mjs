import{ba as O,da as F}from"https://app.framerstatic.com/chunk-LTYMRFFX.mjs";import{f as A}from"https://app.framerstatic.com/chunk-EZF75KBF.mjs";import{e as j}from"https://app.framerstatic.com/chunk-XW2R7BKI.mjs";import{a as w}from"https://app.framerstatic.com/chunk-DFNFZLDR.mjs";import{j as m}from"https://app.framerstatic.com/chunk-AHQIRSXG.mjs";var x=new F(w().api);var u=Object.freeze({"X-Requested-By":"Framer"});async function B(o,t){let n=o.getReader(),e;for(;!(e=await n.read()).done;)t(e.value)}function I(o){let t,n,e,r=!1;return function(i){t===void 0?(t=i,n=0,e=-1):t=J(t,i);let a=t.length,c=0;for(;n<a;){r&&(t[n]===10&&(c=++n),r=!1);let d=-1;for(;n<a&&d===-1;++n)switch(t[n]){case 58:e===-1&&(e=n-c);break;case 13:r=!0;case 10:d=n;break}if(d===-1)break;o(t.subarray(c,d),e),c=n,e=-1}c===a?t=void 0:c!==0&&(t=t.subarray(c),n-=c)}}function q(o,t,n){let e=$(),r=new TextDecoder;return function(i,a){if(i.length===0)n?.(e),e=$();else if(a>0){let c=r.decode(i.subarray(0,a)),d=a+(i[a+1]===32?2:1),l=r.decode(i.subarray(d));switch(c){case"data":e.data=e.data?e.data+`
`+l:l;break;case"event":e.event=l;break;case"id":o(e.id=l);break;case"retry":let h=parseInt(l,10);isNaN(h)||t(e.retry=h);break}}}}function J(o,t){let n=new Uint8Array(o.length+t.length);return n.set(o),n.set(t,o.length),n}function $(){return{data:"",event:"",id:"",retry:void 0}}var V=function(o,t){var n={};for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&t.indexOf(e)<0&&(n[e]=o[e]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,e=Object.getOwnPropertySymbols(o);r<e.length;r++)t.indexOf(e[r])<0&&Object.prototype.propertyIsEnumerable.call(o,e[r])&&(n[e[r]]=o[e[r]]);return n},v="text/event-stream",_=1e3,U="last-event-id";function L(o,t){var{signal:n,headers:e,onopen:r,onmessage:s,onclose:i,onerror:a,openWhenHidden:c,fetch:d}=t,l=V(t,["signal","headers","onopen","onmessage","onclose","onerror","openWhenHidden","fetch"]);return new Promise((h,N)=>{let p=Object.assign({},e);p.accept||(p.accept=v);let y;function C(){y.abort(),document.hidden||k()}c||document.addEventListener("visibilitychange",C);let P=_,E=0;function S(){document.removeEventListener("visibilitychange",C),window.clearTimeout(E),y.abort()}n?.addEventListener("abort",()=>{S(),h()});let H=d??window.fetch,Q=r??z;async function k(){var T;y=new AbortController;try{let g=await H(o,Object.assign(Object.assign({},l),{headers:p,signal:y.signal}));await Q(g),await B(g.body,I(q(f=>{f?p[U]=f:delete p[U]},f=>{P=f},s))),i?.(),S(),h()}catch(g){if(!y.signal.aborted)try{let f=(T=a?.(g))!==null&&T!==void 0?T:P;window.clearTimeout(E),E=window.setTimeout(k,f)}catch(f){S(),N(f)}}}k()})}function z(o){let t=o.headers.get("content-type");if(!t?.startsWith(v))throw new Error(`Expected content-type to be ${v}, Actual: ${t}`)}var M=(o,t)=>{if(!t)return o;let n=new URL(o);for(let e in t){let r=t[e];if(r!==void 0){if(j(r)){for(let s of r)s&&n.searchParams.append(`${e}[]`,s.toString());continue}n.searchParams.append(e,r.toString())}}return n.href},W=o=>{throw new O({isTemporary:!0,message:"Connection error",code:-1e3,status:0,skipSentry:!0,cause:o})};function X(o){return o instanceof DOMException&&o.name==="AbortError"}async function D(o){if(o.ok)return o;o.status===401&&await x.discardAccessToken(!0);let t=o.statusText,n,e,r;try{let{error:s,ref:i,data:a}=await o.json();typeof s?.message=="string"&&(t=s.message),typeof s?.code=="number"&&(n=s.code),typeof i=="string"&&(e=i),typeof a=="object"&&a&&(r=a)}catch{}throw new O({data:r,message:t,status:o.status,ref:e,code:n})}var R=class{constructor(t){this.baseURL=t;m(this,"activeRequestCount",0);m(this,"waitListeners",new Set);m(this,"readonly",!1)}debugSetReadOnly(t=!0){this.readonly=t}doWithListeners(t){this.activeRequestCount++;try{return t().finally(()=>{if(this.activeRequestCount--,this.activeRequestCount===0){let n=Array.from(this.waitListeners);this.waitListeners.clear();for(let e of n)try{e()}catch{}}})}catch(n){this.activeRequestCount--;let e=n instanceof Error?n.message:String(n);throw A("application_error",{message:e,area:"fetch"}),n}}fetch(t,n){return this.doWithListeners(async()=>{let e=await this.accessTokenRefresher.withAuthorizationHeader(n||{});return fetch(t,e).catch(r=>{if(X(r))throw r;W(r)}).then(D)})}fetchStream(t,{headers:n={},onopen:e,...r}={}){return this.doWithListeners(async()=>{let s=await this.accessTokenRefresher.getAuthorizationHeaderValue(),i={...r,headers:s?{...n,authorization:s}:n,async onopen(a){await D(a),await e?.(a)}};return L(t,i).catch(W)})}wait(t){if(this.activeRequestCount===0){t();return}this.waitListeners.add(t)}async getRaw(t,n,e){return await this.fetch(M(`${this.baseURL}${t}`,n),{credentials:"include",redirect:"error",signal:e})}async get(t,n,e){let r=await this.getRaw(t,n,e);return b(r)?r.json():r.text()}async postRaw(t,n,e,r){if(this.readonly)throw Error("apiFetcher is set to readonly");let i=typeof n<"u"&&e?{"Content-Type":e,...u}:u;return await this.fetch(`${this.baseURL}${t}`,{method:"POST",credentials:"include",redirect:"error",headers:i,body:n,signal:r})}async post(t,n,e){if(this.readonly)throw Error("apiFetcher is set to readonly");let r=await this.postRaw(t,JSON.stringify(n),"application/json",e);return b(r)?r.json():r.text()}postStream(t,n,e){if(this.readonly)throw Error("apiFetcher is set to readonly");let r=typeof e<"u",s=r?{"Content-Type":"application/json",...u}:u;return this.fetchStream(`${this.baseURL}${t}`,{...n,method:"POST",credentials:"include",headers:s,body:r?JSON.stringify(e):null})}async putRaw(t,n,e){if(this.readonly)throw Error("apiFetcher is set to readonly");let s=typeof n<"u"&&e?{"Content-Type":e,...u}:u;return await this.fetch(`${this.baseURL}${t}`,{method:"PUT",credentials:"include",headers:s,body:n})}async put(t,n){if(this.readonly)throw Error("apiFetcher is set to readonly");let e=await this.putRaw(t,JSON.stringify(n),"application/json");return b(e)?e.json():e.text()}async deleteRaw(t,n,e){if(this.readonly)throw Error("apiFetcher is set to readonly");let s=typeof n<"u"&&e?{"Content-Type":e,...u}:u;return await this.fetch(`${this.baseURL}${t}`,{method:"DELETE",credentials:"include",redirect:"error",body:n,headers:s})}async delete(t,n){if(this.readonly)throw Error("apiFetcher is set to readonly");let e=await this.deleteRaw(t,JSON.stringify(n),"application/json");return b(e)?e.json():e.text()}get accessTokenRefresher(){return x}};function b(o){let t=o.headers.get("Content-Type");return t!==null&&t.toLowerCase().startsWith("application/json")}var me=new R(w().api);export{x as a,u as b,X as c,me as d};
//# sourceMappingURL=https://app.framerstatic.com/chunk-DECIE6AJ.mjs.map
